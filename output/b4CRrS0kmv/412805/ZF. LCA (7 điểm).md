# ZF. LCA (7 Ä‘iá»ƒm)

## ğŸ“– Problem

Cho cÃ¡i cÃ¢y
$n$
Ä‘á»‰nh vÃ 
$n-â€‰1$
cáº¡nh vá»›i gá»‘c ban Ä‘áº§u lÃ 
$1$
. CÃ³
$q$
truy váº¥n, má»—i truy váº¥n thuá»™c
$1$
trong
$2$
loáº¡i
*
$!$
$root$
$(1â€‰â‰¤rootâ‰¤n)$
: Chá»n
$root$
lÃ m gá»‘c cá»§a cÃ¢y
*
$?$
$u$
$v$
$(1â€‰â‰¤u,vâ‰¤n)$
: TÃ¬m tá»• tiÃªn chung gáº§n nháº¥t cá»§a
$u$
vÃ 
$v$
YÃªu cáº§u:
Vá»›i má»—i truy váº¥n dáº¡ng
$?$
hÃ£y Ä‘Æ°a ra cÃ¢u tráº£ lá»i.


## ğŸ§© Input

Input
DÃ²ng Ä‘áº§u gá»“m
$n$
$(1â€‰â‰¤nâ‰¤â€‰2â€‰*â€‰105)$
$n-â€‰1$
dÃ²ng tiáº¿p theo má»—i dÃ²ng gá»“m
$2$
Ä‘á»‰nh
$u$
vÃ 
$v$
DÃ²ng tiáº¿p theo gá»“m
$q$
$(1â€‰â‰¤qâ‰¤â€‰2â€‰*â€‰105)$
$q$
dÃ²ng tiáº¿p theo má»—i dÃ²ng thuá»™c
$1$
trong
$2$
loáº¡i truy váº¥n mÃ´ táº£ phÃ­a trÃªn.


## ğŸ’¡ Output

Output
Gá»“m cÃ¡c dÃ²ng á»©ng vá»›i Ä‘Ã¡p Ã¡n cá»§a cÃ¡c truy váº¥n
$?$


## ğŸ§  Example

### Input

```text
9
1 2
1 3
2 4
2 5
3 6
3 7
6 8
6 9
7
? 4 5
? 5 6
? 8 7
! 6
? 4 5
? 5 6
? 8 7
```

### Output

```text
2
1
3
2
6
6
```



## ğŸ“ Note

Note
CÃ¢y vá»›i gá»‘c lÃ 
$1$
![](https://espresso.codeforces.com/8387d5cce25ee514ace5334609f8290087b77545.png)
CÃ¢y vá»›i gá»‘c lÃ 
$6$
![](https://espresso.codeforces.com/36ae5eaa802e1dd3dacec333733f52458fbbcc2e.png)

