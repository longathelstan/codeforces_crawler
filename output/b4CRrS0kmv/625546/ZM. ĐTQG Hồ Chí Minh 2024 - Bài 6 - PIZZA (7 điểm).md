# ZM. ÄTQG Há»“ ChÃ­ Minh 2024 - BÃ i 6 - PIZZA (7 Ä‘iá»ƒm)

## ğŸ“– Problem

Hannah gáº§n Ä‘Ã¢y Ä‘Ã£ khÃ¡m phÃ¡ niá»m Ä‘am mÃª lÃ m bÃ¡nh pizza, vÃ  quyáº¿t Ä‘á»‹nh má»Ÿ má»™t tiá»‡m pizza á»Ÿ trung tÃ¢m Stockholm. CÃ´ lÃ m Ä‘iá»u nÃ y vá»›i sá»± giÃºp Ä‘á»¡ cá»§a em gÃ¡i, Holly, ngÆ°á»i chá»‹u trÃ¡ch nhiá»‡m giao pizza. Tiá»‡m pizza cá»§a há» ngay láº­p tá»©c Ä‘Æ°á»£c ngÆ°á»i dÃ¢n Ä‘á»‹a phÆ°Æ¡ng yÃªu thÃ­ch, nhÆ°ng tháº­t khÃ´ng may, tiá»‡m liÃªn tá»¥c bá»‹ thua lá»—. Hannah Ä‘á»• lá»—i cho cam káº¿t giao hÃ ng mÃ  há» Ä‘Æ°a ra khi quáº£ng cÃ¡o tiá»‡m:
"Báº¡n Ä‘ang thÃ¨m má»™t chiáº¿c pizza ngon tuyá»‡t? Báº¡n muá»‘n nÃ³ ngay bÃ¢y giá»? HÃ£y Ä‘áº·t hÃ ng táº¡i tiá»‡m pizza cá»§a Hannah vÃ  chÃºng tÃ´i sáº½ giao pizza Ä‘áº¿n táº­n cá»­a nhÃ  báº¡n. Náº¿u quÃ¡ 20 phÃºt ká»ƒ tá»« lÃºc báº¡n Ä‘áº·t hÃ ng cho Ä‘áº¿n khi nháº­n Ä‘Æ°á»£c pizza cá»§a Hannah, pizza sáº½
miá»…n phÃ­
!"
Máº·c dÃ¹ xe giao hÃ ng cá»§a Holly cÃ³ thá»ƒ chá»Ÿ sá»‘ lÆ°á»£ng pizza khÃ´ng giá»›i háº¡n, nhÆ°ng cÃ´ áº¥y khÃ´ng thá»ƒ theo ká»‹p sá»‘ lÆ°á»£ng Ä‘Æ¡n Ä‘áº·t hÃ ng lá»›n, cÃ³ nghÄ©a lÃ  há» Ä‘Ã£ pháº£i táº·ng miá»…n phÃ­ khÃ¡ nhiá»u chiáº¿c pizza vÃ¬ giao trá»….
Äá»ƒ tÃ¬m cÃ¡ch kháº¯c phá»¥c tÃ¬nh tráº¡ng nÃ y, Hannah Ä‘Ã£ nhá» báº¡n giÃºp phÃ¢n tÃ­ch cÃ¡c Ä‘Æ¡n hÃ ng cá»§a ngÃ y hÃ´m qua. Cá»¥ thá»ƒ, náº¿u Holly biáº¿t trÆ°á»›c toÃ n bá»™ cÃ¡c Ä‘Æ¡n hÃ ng vÃ  Ã¡p dá»¥ng chiáº¿n lÆ°á»£c giao hÃ ng tá»‘i Æ°u, thÃ¬ thá»i gian dÃ i nháº¥t mÃ  má»™t khÃ¡ch hÃ ng pháº£i Ä‘á»£i ká»ƒ tá»« khi Ä‘áº·t hÃ ng cho Ä‘áº¿n khi nháº­n Ä‘Æ°á»£c pizza sáº½ lÃ  bao nhiÃªu?
Hannah cung cáº¥p cho báº¡n báº£n Ä‘á»“ cÃ¡c con Ä‘Æ°á»ng vÃ  cÃ¡c nÃºt giao á»Ÿ Stockholm. CÃ´ áº¥y cÅ©ng Ä‘Æ°a danh sÃ¡ch cÃ¡c Ä‘Æ¡n hÃ ng cá»§a ngÃ y hÃ´m qua: Ä‘Æ¡n hÃ ng $$$i$$$ Ä‘Æ°á»£c Ä‘áº·t lÃºc $$$s_i$$$, táº¡i nÃºt giao $$$u_i$$$, vÃ  pizza cá»§a Ä‘Æ¡n hÃ ng nÃ y Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ giao lÃºc $$$t_i$$$. Hannah tuÃ¢n thá»§ nghiÃªm ngáº·t nguyÃªn táº¯c "
Ä‘áº¿n trÆ°á»›c, phá»¥c vá»¥ trÆ°á»›c
": náº¿u Ä‘Æ¡n hÃ ng $$$i$$$ Ä‘Æ°á»£c Ä‘áº·t trÆ°á»›c Ä‘Æ¡n hÃ ng $$$j$$$ (tá»©c $$$s_i < s_j$$$), thÃ¬ pizza cá»§a $$$i$$$ sáº½ ra lÃ² trÆ°á»›c pizza cá»§a $$$j$$$ (tá»©c $$$t_i < t_j$$$), vÃ  pizza cá»§a $$$i$$$ pháº£i Ä‘Æ°á»£c giao trÆ°á»›c pizza cá»§a $$$j$$$.


## ğŸ§© Input

Input
DÃ²ng Ä‘áº§u tiÃªn chá»©a hai sá»‘ nguyÃªn $$$n$$$ vÃ  $$$m$$$ $$$(2 \le n \le 1000,\ 1 \le m \le 5000)$$$, trong Ä‘Ã³ $$$n$$$ lÃ  sá»‘ nÃºt giao á»Ÿ Stockholm vÃ  $$$m$$$ lÃ  sá»‘ con Ä‘Æ°á»ng. Tiáº¿p theo $$$m$$$ dÃ²ng, má»—i dÃ²ng chá»©a ba sá»‘ nguyÃªn $$$u_i, v_i, d_i$$$ $$$(1 \le u_i, v_i \le n,\ u_i \ne v_i)$$$, cho biáº¿t cÃ³ má»™t con Ä‘Æ°á»ng hai chiá»u ná»‘i $$$u_i$$$ vÃ  $$$v_i$$$, máº¥t $$$d_i$$$ Ä‘Æ¡n vá»‹ thá»i gian Ä‘á»ƒ Ä‘i qua theo cáº£ hai hÆ°á»›ng $$$(0 \le d_i \le 10^8)$$$. Giá»¯a má»—i cáº·p nÃºt giao cÃ³ nhiá»u nháº¥t má»™t con Ä‘Æ°á»ng.
Tiáº¿p theo lÃ  má»™t dÃ²ng chá»©a sá»‘ nguyÃªn $$$k$$$ $$$(1 \le k \le 1000)$$$ â€” sá»‘ lÆ°á»£ng Ä‘Æ¡n hÃ ng. Sau Ä‘Ã³ lÃ  $$$k$$$ dÃ²ng, má»—i dÃ²ng chá»©a ba sá»‘ nguyÃªn $$$s_i, u_i, t_i$$$ cho biáº¿t Ä‘Æ¡n hÃ ng Ä‘Æ°á»£c Ä‘áº·t lÃºc $$$s_i$$$, tá»« nÃºt giao $$$u_i$$$ $$$(2 \le u_i \le n)$$$, vÃ  Ä‘Æ¡n hÃ ng Ä‘Ã£ sáºµn sÃ ng Ä‘á»ƒ giao lÃºc $$$t_i$$$ $$$(0 \le s_i \le t_i \le 10^8)$$$. CÃ¡c Ä‘Æ¡n hÃ ng Ä‘Æ°á»£c cho theo thá»© tá»± tÄƒng dáº§n thá»i gian Ä‘áº·t hÃ ng, tá»©c $$$s_i < s_j$$$ vÃ  $$$t_i < t_j$$$ vá»›i má»i $$$1 \le i < j \le k$$$.
Tiá»‡m pizza cá»§a Hannah náº±m táº¡i nÃºt giao sá»‘ $$$1$$$, vÃ  Holly cÃ¹ng xe giao hÃ ng xuáº¥t phÃ¡t tá»« Ä‘Ã³ lÃºc $$$0$$$. LuÃ´n cÃ³ thá»ƒ Ä‘i tá»« tiá»‡m pizza Ä‘áº¿n báº¥t ká»³ nÃºt giao nÃ o.


## ğŸ’¡ Output

Output
Xuáº¥t ra má»™t sá»‘ nguyÃªn duy nháº¥t â€” thá»i gian dÃ i nháº¥t mÃ  má»™t khÃ¡ch hÃ ng pháº£i chá» tá»« lÃºc Ä‘áº·t hÃ ng cho Ä‘áº¿n khi nháº­n pizza, giáº£ sá»­ Holly biáº¿t toÃ n bá»™ Ä‘Æ¡n hÃ ng vÃ  tá»‘i Æ°u hÃ³a quÃ¡ trÃ¬nh giao hÃ ng.


## ğŸ§  Example

### Input

```text
4 4
1 2 2
2 3 4
3 4 1
4 1 2
3
1 4 2
3 3 3
4 3 6
```

### Output

```text
6
```



## ğŸ“ Note

Note
Giáº£i thÃ­ch cho vÃ­ dá»¥ máº«u thá»© nháº¥t:
```
1-(2)-2
|     |
(2)   (4)
|     |
4-(1)-3
```
*
3: láº¥y pizza sá»‘ 1 vÃ  2
*
5: giao pizza sá»‘ 1 (giao táº¡i giao lá»™ 4)
*
6: giao pizza sá»‘ 2 (giao táº¡i giao lá»™ 3)
*
9: láº¥y pizza sá»‘ 3
*
11: giao pizza sá»‘ 3 (giao táº¡i giao lá»™ 7)
*
6: láº¥y pizza sá»‘ 1, 2, 3
*
8: giao pizza sá»‘ 1 (giao táº¡i giao lá»™ 7)
*
9: giao pizza sá»‘ 2 vÃ  3 (giao táº¡i cÃ¡c giao lá»™ 6 vÃ  5)
*
2: láº¥y pizza sá»‘ 1
*
4: giao pizza sá»‘ 1 (giao táº¡i giao lá»™ 3)
*
6: láº¥y pizza sá»‘ 2 vÃ  3
*
9: giao pizza sá»‘ 2 vÃ  3 (giao táº¡i cÃ¡c giao lá»™ 6 vÃ  5)

